var U=Object.defineProperty;var j=(n,t,i)=>t in n?U(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var v=(n,t,i)=>(j(n,typeof t!="symbol"?t+"":t,i),i);import"./modulepreload-polyfill.b7f2da20.js";import{W as O,Z as T,S as N,i as P,T as x,m as p,_ as h,a as z,$ as E,K as R,g as A,a0 as w,a1 as y,a2 as L,s as S,b,Y as g,c,a3 as X,a4 as D,f as Y,n as V,O as F}from"./vendor.cce8fb4b.js";class q{constructor(t){this.container=t,this.renderer=new O({antialias:!0}),this.renderer.setSize(t.offsetWidth,t.offsetHeight,!1),this.renderer.setPixelRatio(window.devicePixelRatio),t.append(this.renderer.domElement),t.offsetWidth,t.offsetHeight,100*t.offsetWidth/t.offsetHeight,100*t.offsetWidth/t.offsetHeight;const i=t.offsetWidth/t.offsetHeight,s=1e3,e=s/i;this.camera=new T(s/-2,s/2,e/2,e/-2,0,1e3),this.scene=new N,this.scene.add(this.camera),this.clock=new P,this.assets={},this.disposed=!1,this.tick=this.tick.bind(this),this.init=this.init.bind(this)}loadAssets(){return new Promise((t,i)=>{})}init(){this.tick()}getViewSizeAtDepth(t=0){const i=this.camera.fov*Math.PI/180,s=Math.abs((this.camera.position.z-t)*Math.tan(i/2)*2);return{width:s*this.camera.aspect,height:s}}dispose(){this.disposed=!0}onResize(){}update(){}render(){this.renderer.render(this.scene,this.camera)}tick(){if(this.disposed)return;if(G(this.renderer)){const i=this.renderer.domElement;this.camera.aspect=i.clientWidth/i.clientHeight,this.camera.updateProjectionMatrix(),this.onResize()}const t=this.clock.getDelta();this.render(t),this.update(t),requestAnimationFrame(this.tick)}}function G(n){const t=n.domElement,i=t.clientWidth,s=t.clientHeight,e=t.width!==i||t.height!==s;return e&&n.setSize(i,s,!1),e}var W="data:image/png;base64,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";const K=container.offsetWidth/container.offsetHeight,m=1e3,d=m/K;var H="/playground1/assets/ball3.a882feb9.png";const C=new x;var J=C.load(W);const Z=C.load(H);class I{constructor(t){v(this,"ticks",0);this.app=t,this.vel=new p(1,1,0)}revive(){this.mesh.position.set(0,60,0),this.mesh.material.color.set(16777215)}die(){this.app.scene.remove(this.mesh),this.mesh.removeFromParent(),this.geometry.dispose(),this.material.dispose(),this.geometry=null,this.material=null,this.mesh=null}hitBrick(t){this.mesh.material.color=t.mesh.material.uniforms.uColor.value.clone(),this.mesh.material.color.multiplyScalar(1),this.app.effects.showHit(t.mesh.position),h.fromTo(this.mesh.scale,{x:.5},{x:1,duration:.1})}init(){this.geometry=new z(10,32,32),this.material=new E({side:R,map:Z});var t=new A(this.geometry,this.material);t.position.y=60,t.position.x=0,t.position.z=0,this.mesh=t,this.power=1;const i=new w({map:J});this.smoke2=new y(i),this.app.scene.add(this.smoke2),this.app.scene.add(t)}bounce(){const t=Math.random()*20;this.smoke2.material.rotation=10*Math.random(),this.smoke2.position.copy(this.mesh.position),this.smoke2.position.z=5,h.fromTo(this.mesh.scale,{x:.2},{x:1,duration:.1}),h.timeline().fromTo(this.smoke2.scale,{x:0,y:0,z:0},{duration:.1,x:50-t,y:50-t,z:1}).fromTo(this.smoke2.material,{opacity:1},{duration:.2,opacity:0},0)}update(t){this.ticks++;let i=Math.min(3+t*.04,7),s=this.vel,e=10/2,o=10/2,r=this.mesh.position.x,a=this.mesh.position.y;(r+e>m/2||this.mesh.position.x-e<-m/2)&&(s.reflect(new p(1,0,0)),this.bounce()),(a+o>d/2||a-o<-d/2)&&(s.reflect(new p(0,1,0)),this.bounce());let l=s.clone().multiplyScalar(i);this.mesh.rotateZ(.05),this.mesh.position.add(l),this.ticks%2==0&&this.app.effects.showClouds(1,this.mesh.position,50)}}class _{init(){this.startDate=new Date}isBloodSugarLow(){if(this.bloodSugar<=4)return!0}isBloodSugarNormal(){if(this.bloodSugar>4&&this.bloodSugar<10)return!0}isBloodSugarHigh(){if(this.bloodSugar>=10)return!0}getBloodSugar(t){return Math.max(Math.cos(t*.1)*8.14+(1+Math.sin(t*.2))*7,2)}update(t){this.bloodSugar=this.getBloodSugar(t)}}const $=`
uniform vec3 uColor;
uniform float uAlpha;
varying vec3 vPositionW;
varying vec3 vNormalW;
varying vec3 normals;
varying vec2 vUv;
void main() {
	vec3 color = vec3(1., 1., 1.);
	vec3 viewDirectionW = normalize(cameraPosition - vPositionW);
	float fresnelTerm = dot(viewDirectionW, vNormalW);
	fresnelTerm = clamp(fresnelTerm,0.9, 2.0);

	color = uColor;
	

	// borders
	
	// if(vUv.x > .95) {
	// 	color = vec3(1., 0., 0.);
	// }

	// float b = step(vUv.x, 0.95);	
	// color *= b;
	// b = step(0.05, vUv.x);
	// color *= b;

	//color.r *= vUv.x ;
	//color.r *= vPositionW.x;
	//color.g *= vUv.y;

    gl_FragColor = vec4(color, uAlpha);
    //gl_FragColor = vec4(uColor, 1.0);
}
`,tt=`
varying vec3 vPositionW;
varying vec3 vNormalW;
varying vec2 vUv;

void main() {
    vUv = uv;
    vPositionW = vec3( vec4( position, 1.0 ) * modelMatrix);
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`;var it="/playground1/assets/ball1.1a2ffa70.png",et="/playground1/assets/ball2.466a70af.png",st="/playground1/assets/hit1.edfa9731.m4a",ot="/playground1/assets/hit2.b10388c2.m4a",at="/playground1/assets/hit3.401d0d66.m4a",rt="/playground1/assets/hit4.18e89af6.m4a",nt="/playground1/assets/hit5.3595b5da.m4a",ht=[st,ot,at,rt,nt],lt=ht.map(n=>new L.Howl({src:n,sprite:{__default:[100,1e3]}}));const B=n=>Array.isArray(n)?n[Math.floor(Math.random()*n.length)]:n,M=new x,ct=M.load(it),mt=M.load(et),dt=["","#fbff80","#cc6cf5","#80c6ff","orange"];class pt{constructor(t,i,s,e,o,r){this.app=t,this.brickPoints=i,this.rows=s,this.columns=e,this.row=o,this.column=r}init(){const t=m/10,i=15,s=10;this.points=B(this.brickPoints),this.life=this.points,this.ability=this.getAbility(),this.reinit();var e=new S(t-s,i,1),o=new b({fragmentShader:$,vertexShader:tt,uniforms:{uColor:new g(new c(this.config.color)),uAlpha:new g(1),uTime:new g(0)},transparent:!0,opacity:1,side:R}),r=new A(e,o);r.position.y=d/2-i/2-50,r.position.y-=i*(this.row+1)+10*this.row,r.position.x=-m/2+t*this.column,this.mesh=r,this.group=new X,this.group.add(r),this.applyAbility(),this.app.scene.add(this.group)}applyAbility(){if(this.ability){let t="";this.ability==="bomb-column"?t=ct:this.ability==="extra-ball"&&(t=mt);const i=new w({map:t});this.meshEffect=new y(i),this.meshEffect.scale.set(40,40,10),this.meshEffect.position.copy(this.mesh.position),this.meshEffect.position.z=5,this.meshEffect.material.opacity=1,this.group.add(this.meshEffect)}else this.meshEffect&&(this.group.remove(this.meshEffect),this.meshEffect.material.dispose(),this.meshEffect.mater=null,this.meshEffect.geometry.dispose(),this.meshEffect.geometry=null,this.meshEffect=null)}reinit(){let t=dt[this.points];this.config={opacity:1,color:t}}hit(t=1){this.life-=t,this.mesh.rotateZ(Math.random()*.2),B(lt).play(),this.isDead()&&this.destroy();const i=this.ability;return this.looseAbility(),{points:this.getPoints(),ability:i}}looseAbility(){this.ability=null,this.applyAbility()}getPoints(){if(this.isDead())return this.points}destroy(){this.app.effects.showExplosions(1,this.mesh.position),this.mesh.material.uniforms.uAlpha.value=0,h.to(this.config,{duration:.5,opacity:0})}isDead(){return this.life<1}isActive(){return this.life>0}allChildren(t){this.group.children.forEach(i=>{i instanceof D&&t(i)})}revive(){this.life=this.points,this.mesh.material.uniforms.uAlpha.value=1,this.mesh.rotation.z=0,this.ability=this.getAbility(),this.applyAbility(),this.config.opacity=1}getAbility(){return Math.random()<.9?null:B(["bomb-column","extra-ball"])}update(t){this.time=t,this.mesh.material.uniforms.uTime.value=t,this.allChildren(i=>{i.material instanceof w?i.material.opacity=this.config.opacity:i.material instanceof b&&i.material.uniforms.uPacity&&(i.material.uniforms.uOpacity.value=this.config.opacity)})}}const ft=`
uniform vec3 uColor;
uniform float uAlpha;
uniform vec2 uResolution;
uniform float uTime;
varying vec3 vPositionW;
varying vec3 vNormalW;
varying vec2 vUv;

float dist(vec2 p0, vec2 pf){return sqrt((pf.x-p0.x)*(pf.x-p0.x)+(pf.y-p0.y)*(pf.y-p0.y));}

void main() {

    
			vec3 color = vec3(1., 1., 1.);
			vec3 viewDirectionW = normalize(cameraPosition - vPositionW);
			float fresnelTerm = .5 - dot(viewDirectionW, vNormalW);
			fresnelTerm = clamp(fresnelTerm,0.0, .9);

		vec2 sc = vPositionW.xy/uResolution;
		float c = clamp(sc.x, .9, 1.);
		float a = c;
		float circle = dist(uResolution*0.5, vPositionW.xy) * 0.002 + sin(uTime) * 0.1;
		float offset = .14 + sin(uTime * 2.) * 0.1;
        gl_FragColor = vec4( uColor, (circle - offset) * uAlpha);
    
	

    //gl_FragColor = vec4(uColor, 1.0);
}
`;class ut{constructor(t){this.app=t}init(){var t=new Y(m,d);const i=["varying vec3 vPositionW;","varying vec3 vNormalW;varying vec2 vUv;","void main() {"," vUv = uv;","	vPositionW = vec3( vec4( position, 1.0 ) * modelMatrix);"," vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`);var s=new b({fragmentShader:ft,vertexShader:i,transparent:!0,uniforms:{uReslution:new g(new V(m,d)),uColor:new g(new c("#000000")),uAlpha:new g(0),uTime:new g(0)}});this.mesh=new A(t,s),this.mesh.position.z=10,this.app.scene.add(this.mesh),this.isShown=!1}show(){this.isShown||(this.isShown=!0,h.to(this.mesh.material.uniforms.uAlpha,{duration:.5,value:.7}))}hide(){this.isShown&&(h.to(this.mesh.material.uniforms.uAlpha,{duration:.5,value:0}),this.isShown=!1)}update(t){this.mesh.material.uniforms.uTime.value=t}}class vt{constructor(t){this.app=t,this.vel=new p(0,0,0)}init(){const t=5;var i=new S(200,50,10),s=new E({color:new c("#56cc7d")}),e=new A(i,s);e.position.y=-d/2+t/2,e.position.x=0,this.mesh=e,this.app.scene.add(e);let o=[];const r=()=>{const a=o[0];a=="ArrowLeft"?this.vel.x=-1:a=="ArrowRight"?this.vel.x=1:this.vel.x=0};window.addEventListener("keydown",a=>{o.unshift(a.key),r()}),window.addEventListener("touchmove",a=>{console.log(a),a.touches[0].clientX}),window.addEventListener("keyup",a=>{o=o.filter(l=>l!==a.key),r()})}hit(){this.mesh.material.color.set(new c("lightBlue")),h.timeline().to(this.mesh.scale,{duration:.05,y:.3,ease:"expo.out",yoyo:!0,repeat:1}),h.fromTo(this.mesh.scale,{x:.5},{x:1,duration:.3})}update(t,i){let s=10,e=this.vel,o=200/2;this.mesh.position.x,i?(this.mesh.scale.x=.6,this.mesh.material.color=new c("#ff0000")):(this.mesh.scale.x=1,this.mesh.material.color=new c("#56cc7d"));let r=e.clone().multiplyScalar(s);this.mesh.position.add(r).clamp(new p(-m/2+o,-d),new p(m/2-o,d))}}var gt="data:image/png;base64,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";const Q=new x,wt=Q.load(gt),At=Q.load(W);class yt{constructor(){v(this,"explosions",[]);v(this,"clouds",[]);v(this,"lastExplosion",0);v(this,"lastCloud",0)}init(t){this.app=t,this.setupExplosions(),this.setupClouds()}showClouds(t,i,s,e){e=e||c.white;for(let o=0;o<t;o++){const r=this.lastCloud++%this.clouds.length,a=this.clouds[r];a.position.copy(i),a.material.color.set(e),s=s||40,s+=s/2*Math.random(),h.fromTo(a.material,{opacity:1},{duration:.7,opacity:0}),h.to(a.material,{duration:1,rotation:Math.PI*Math.random()*Math.PI}),h.fromTo(a.scale,{x:0,y:0},{duration:1,x:s,y:s})}}setupClouds(){this.clouds=[];const t=50;let i=At;const s=new w({map:i});for(let e=0;e<t;e++){const o=new y(s.clone());o.scale.set(0,0,0),o.opacity=0,this.clouds.push(o),this.app.scene.add(o)}}setupExplosions(){this.explosions=[];const t=5;let i=wt;const s=new w({map:i});for(let e=0;e<t;e++){const o=new y(s.clone());o.scale.set(0,0,0),o.opacity=0,this.explosions.push(o),this.app.scene.add(o)}}showHit(t){let i=t.clone();i.z=1,this.showExplosions(1,i,40,c.red)}showExplosions(t,i,s,e){e=e||c.white;for(let o=0;o<t;o++){const r=this.lastExplosion++%this.explosions.length,a=this.explosions[r];a.position.copy(i),a.material.color.set(e),s=s||40,s+=s/2*Math.random(),h.fromTo(a.material,{opacity:1},{duration:.7,opacity:0}),h.to(a.material,{duration:1,rotation:Math.PI*Math.random()*Math.PI}),h.fromTo(a.scale,{x:0,y:0},{duration:1,x:s,y:s})}}}class xt extends q{constructor(t){const i={container:document.getElementById("container")};super(i.container);v(this,"isBallAlignedWithBrick",t=>{const i=t.mesh.position.x,s=t.mesh.position.y;return this.bricks.filter(e=>e.isActive()).find(e=>{const o=e.mesh.position.x,r=e.mesh.geometry.parameters.width/2,a=e.mesh.position.y,l=e.mesh.geometry.parameters.height/2,f=i>o-r&&i<o+r,u=s<a+l&&s>a-l;return f&&u?e:!1})});this.options=i,this.camera.position.z=10,this.camera.position.y=0,this.camera.rotation.z=0;const s=new yt;this.effects=s,s.init(this),this.modifiers=new _,this.ui={bs:document.getElementById("bs"),bstext:document.querySelector("#bs .text")};let e=new vt(this);e.init(),this.padel=e;const o=new I(this);o.init(),this.balls=[o],this.overlay=new ut(this),this.overlay.init(),this.bricks=[],this.points_record=0,this.hits=0,this.hits_last=0,this.hits_rate=0;const r=6,a=10,l=[1,1,1,1,2,2,2,3,3,4,4];for(let f=0;f<r;f++)for(let u=0;u<a;u++){const k=new pt(this,l,r,a,f,u);k.init(),this.bricks.push(k)}this.scene.background=new c("pink")}init(){this.points=0,this.points_record=localStorage.getItem("points_record"),this.updateScores(),this.controls=new F(this.camera,this.renderer.domElement),this.controls.enabled=!1,this.tick()}updateScores(){document.getElementById("last_score").innerText=this.points_record,document.getElementById("score").innerText=this.points}hitsFloor(t){return t.mesh.position.y<-d/2+10}updateBs(t,i){var s=this.modifiers.getBloodSugar(t);this.ui.bstext.innerText=s.toFixed(1),i?(this.overlay.show(),this.ui.bs.classList.add("low")):(this.overlay.hide(),this.ui.bs.classList.remove("low")),this.modifiers.isBloodSugarNormal()?this.ui.bs.classList.add("normal"):this.ui.bs.classList.remove("normal"),this.modifiers.isBloodSugarHigh()?this.ui.bs.classList.add("high"):this.ui.bs.classList.remove("high")}hitBrick(t,i,s){var e=t.hit(1);if((e==null?void 0:e.ability)=="bomb-column")this.bricks.forEach(o=>{if(o.column==t.column){const r=10;this.hitBrick(o,r,s)}});else if((e==null?void 0:e.ability)=="extra-ball"){const o=new I(this);o.init(),s.push(o),console.log("new ball",this.balls)}(e==null?void 0:e.points)>0&&(this.hits++,setTimeout(()=>{t.revive()},4e4),this.points+=e.points,this.shake2=!0,setTimeout(()=>{this.shake2=!1},200)),document.getElementById("score").innerText=this.points}ballUpdate(t,i,s){if(t.update(i),this.hitsFloor(t)&&t!=this.balls[0])return t.die(),!1;this.isBallAlignedWithPaddle(t)&&t.vel.y<0&&(this.padel.vel.x<0&&t.vel.x>0||this.padel.vel.x>0&&t.vel.x<0?t.vel.negate():t.vel.reflect(new p(0,1,0)),this.padel.hit(),t.bounce());let e=this.isBallAlignedWithBrick(t);return e&&(t.hitBrick(e),t.vel.reflect(new p(0,1,0)),this.hitBrick(e,t.power,s)),!0}update(t){let i=this.clock.elapsedTime;this.modifiers.update(i);const s=this.modifiers.isBloodSugarLow();this.updateBs(i,s),this.overlay.update(i),i%2==0&&(this.hits_rate=Math.max(1,this.hits-this.hits_last)),this.padel.update(i,s);let e=[];this.balls=this.balls.filter(o=>this.ballUpdate(o,i,e)),this.balls=this.balls.concat(e),this.balls.length==0,this.bricks.forEach(o=>{o.update(i)}),this.shake?this.camera.rotation.z=Math.sin(i*100)*.02:this.shake2?this.camera.rotation.z=Math.sin(i*100)*.005:this.camera.rotation.z=0}die(){this.balls.forEach(i=>{i.mesh.material.color=new c("#000000")});const t=this.points;t>this.points_record&&(console.log("score",t,this.points_record),this.points_record=t,localStorage.setItem("points_record",this.points_record),this.updateScores()),this.clock=new P,setTimeout(()=>{this.points=0,this.updateScores(),this.reviveAll()},4e4)}reviveAll(){this.bricks.forEach(t=>{t.revive()}),this.balls.forEach(t=>{t.revive()})}isBallAlignedWithPaddle(t){const i=t.mesh.position.x,s=this.padel.mesh.position.x,e=this.padel.mesh.geometry.parameters.width/2,o=t.mesh.position.y,r=this.padel.mesh.position.y,a=this.padel.mesh.geometry.parameters.height/2,l=this.padel.mesh.geometry.parameters.height,f=i>s-e-l&&i<s+e+l,u=o<r+a&&o>r;return f&&u}}const bt=new xt;bt.init();
//# sourceMappingURL=sugarbreak.712679fd.js.map
